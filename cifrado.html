<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Cifrador: César & Atbash</title>
    <!-- [1] --> 
    <link href="https://fonts.googleapis.com/css2?family=Sour+Gummy:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <style>
        /* [2] */
        body {font-family: 'Sour Gummy'; font-size: larger; background: #d5cedc; padding: 20px; display: flex; justify-content: center;}
        .container {background: white; padding: 20px; border-radius: 8px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); max-width: 900px; width: 100%;}
        textarea, input, select {font-family: 'Sour Gummy'; font-size: large; width: 100%; margin: 10px 0; padding: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box;}
        button {width: 100%; padding: 10px; background: #524d74; color: white; border: none; border-radius: 4px; cursor: pointer; font-family: 'Sour Gummy'; font-size: large;}
        button:hover {background: #765d9a;}
        h2 {color: #40266f; text-align: center; font-family: 'Sour Gummy';}
        .result {background: #e9ecef; padding: 10px; min-height: 50px; word-break: break-all; margin-top: 10px; border-left: 5px solid #492095;}
    </style>
</head> 

<body>
    <div class="container">
        <h2>Cifrado César y Atbash</h2>
        <!-- [3] -->
        <input type="hidden" id="alphabet" value="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789 ÁÉÍÓÚáéíóúñÑ.,;:!?@#$%&/()=-_+*[]{}">

        <!-- [4] -->
        <label>Mensaje:</label>
        <textarea id="message" placeholder="Escribe tu mensaje aquí..."></textarea>

        <label>Método:</label>
        <select id="method" onchange="toggleShift()">
            <option value="cesar">César (Desplazamiento)</option>
            <option value="atbash">Atbash (Espejo)</option>
        </select>

        <!-- [5] -->
        <div id="shiftContainer">
            <label> Desplazamiento:</label>
            <input type="number" id="shift" value="3">
        </div>

        <!--[6]-->
        <div style="display: flex; gap: 10px;">
            <button onclick="process(1)" style="background: #875298;">Cifrar</button>
            <button onclick="process(-1)" style="background: #614972;">Descifrar</button>
        </div>
        
        <!--[7]-->
        <h3>Resultado:</h3>
        <div id="result" class="result">El resultado aparecerá aquí...</div>
        <p id="detection" style="font-style: italic; color: #555;"></p>

        <!--[8]-->
        <button onclick="copyToClipboard()" style="background: #806f81; margin-top: 5px; font-size: 0.8em;">Copiar Resultado</button>
        <script>
            function copyToClipboard() {
                const text = document.getElementById('result').innerText;
                navigator.clipboard.writeText(text);
            }
        </script>
    </div>

    <script>
        /* [9] */
        function toggleShift() {
            const method = document.getElementById('method').value;
            document.getElementById('shiftContainer').style.display = method === 'cesar' ? 'block' : 'none';
        }

        /* [10] */
        function process(direction) {
            /* [11] */
            const alphabet = document.getElementById('alphabet').value;
            const input = document.getElementById('message').value;
            const method = document.getElementById('method').value;
            let shift = parseInt(document.getElementById('shift').value);
            let output = "";

            /* [12] */
            if (direction === -1 && method === "cesar") {
                shift = -shift;
            }

            /* [13] */
            if (method === "cesar") {
                for (let char of input) {
                    let index = alphabet.indexOf(char);
                    if (index !== -1) {
                        /* [14] */
                        let newIndex = (index + shift) % alphabet.length;
                        if (newIndex < 0) newIndex += alphabet.length; 
                        output += alphabet[newIndex];
                    } else {
                        /* [15] */
                        output += char;
                    }
                }
            } else { 
                /* [16] */
                const reversed = alphabet.split('').reverse().join('');
                for (let char of input) {
                    let index = alphabet.indexOf(char);
                    if (index !== -1) {
                        /* [17] */
                        output += reversed[index];
                    } else {
                        output += char;
                    }
                }
            }
            /* [18] */
            document.getElementById('result').innerText = output;
            const action = direction === 1 ? "CIFRADO" : "DESCIFRADO";
            document.getElementById('detection').innerText = `Módulo: ${method.toUpperCase()} | Acción: ${action}`;
        }
    </script>
</body>
</html>